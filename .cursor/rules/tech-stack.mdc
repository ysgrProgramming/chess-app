---
description: Universal security protocols and dynamic technical stack definitions.
globs: src/**, tests/**, .env*, **/*.{py,js,ts,go,rs,java,rb}
---

# Technical Stack & Security Rules

This file defines the strict security protocols (Universal) and the technology stack (Project-Specific).

## 1. Universal Security Protocols (Non-Negotiable)
These rules apply to **ALL** projects regardless of the language or framework.

### Credentials & Secrets
- `.env` and `.env.*` files are considered sensitive. Do NOT print, commit, or modify their contents via AI.
- **NEVER** commit API keys, tokens, passwords, or certificates to Git.
- **NEVER** hardcode secrets in the source code. Use environment variables.
- **NEVER** output secret values in logs, print statements, or PR descriptions.
- **Mocking:** External services requiring credentials must be mocked in tests.
- `.env` and `.env.*` files are considered sensitive:
  - Do NOT print, commit, or modify their contents via AI.
- Using authenticated CLI tools (e.g. `git`, `gh`) is **allowed**:
  - You may invoke them as black-box commands (e.g. `gh issue create`, `gh pr create`).
  - You must NOT open, read, or echo their configuration files or tokens.
  - You must NOT print environment variables that contain secrets.

### Experimental Code
- Any code that is "experimental", "temporary", or "proof of concept" must be placed in the `scratch/` directory.
- Files in `scratch/` are ignored by `.gitignore` and must **NOT** be included in Pull Requests.

---

## 2. Technology Stack (Dynamic)
*The Architect decides the conceptual stack in `REQUIREMENT.md`. The Manager then creates a "Project Setup" Issue, and the Engineer updates this file accordingly.*

### Core Stack
- **Language:** TypeScript (strict type checking enabled)
- **Framework:** React (SPA) bundled with Vite
- **Database:** None for this phase (in-memory and browser session state only)

### Development Tools
- **Testing Framework:** Vitest + React Testing Library + jsdom test environment
- **Linter/Formatter:** ESLint (TypeScript + React rules) + Prettier
- **Package Manager:** npm (Node.js LTS)

---

## 3. Coding Standards (Dynamic)
*To be filled by the Engineer based on the chosen language's best practices.*

### Style Guide
- Follow TypeScript and React best practices with strict typing enabled (`strict: true` in `tsconfig.json`).
- Prefer explicit, descriptive names (verb+Object for functions, no unclear abbreviations).
- Use functional React components with hooks; avoid legacy class components.

### File Structure
- `src/` contains application code.
- `src/components/` contains presentational and container components.
- `src/lib/` contains shared utilities (e.g., chess engine, domain logic) once introduced.
- `tests/` contains unit and component tests mirroring the `src/` structure.

### Error Handling
- Avoid throwing uncaught errors from UI components; surface recoverable issues via UI state where appropriate.
- For unexpected runtime errors in the browser, prefer fail-safe behavior (e.g., allow user to reset to initial board state).
- No network or persistence layer is used in this phase; if introduced later, all external calls must be wrapped and errors explicitly handled.

---

## 4. Operational Rules for Modifying This File
- The **Universal Security Protocols** section is global and should only be changed in rare cases via a dedicated governance process (Issue + PR + human review).
- **Manager:** Do NOT edit this file directly. Create a `configuration` Issue instructing the Engineer to update the stack definitions.
- **Engineer:** Update the [PENDING] sections in this file as part of the "Project Setup" task or when a configuration change is requested via Issue.